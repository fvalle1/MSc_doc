<h1 id="ch:topicmodelling">Topic modelling</h1>
<p>Once extensively analyzed the structure of the dataset, the goal becomes to develop a machine learning method to learn the hidden structure of the data.</p>
<p>Remembering that in chapter <a href="#ch:structure" data-reference-type="ref" data-reference="ch:structure">[ch:structure]</a> it emerged some kind of structure behind data, where each tissue seemed to be sampled by a different power law, a topic modelling approach it is here proposed.</p>
<p>The idea is that behind data there are hidden variables that describe the relationship between the genes and the samples. Let’s call these variables topics. Firstly it is necessary to build a bipartite network of genes and samples, then nodes are linked considering the gene expression value in the dataset.</p>

<figure>
<embed src="pictures/topic/bipartite.pdf" id="fig:topic/bipartite" /><figcaption>An example of a bipartite network. Samples are on the left, genes are on the right. Each link is weighted by gene expression value. On the left side, all nodes of the same colour are clusters of samples. On the right side, all nodes with the same colour are set of genes, also known as topics.<br />
Blue lines represent the cluster structure, each blue square is a set of nodes, lines delineate the hierarchical structure.<br />
It is clear in the middle the network separation in genes and samples.<span label="fig:topic/bipartite"></span></figcaption>
</figure>
<p>The output of this kind of model consists of sets of genes, the topics, with a probability distribution <span class="math inline"><em>P</em>(<em>g</em><em>e</em><em>n</em><em>e</em>|<em>t</em><em>o</em><em>p</em><em>i</em><em>c</em>)</span> and probability distributions of these topics inside each sample <span class="math inline"><em>P</em>(<em>t</em><em>o</em><em>p</em><em>i</em><em>c</em>|<em>s</em><em>a</em><em>m</em><em>p</em><em>l</em><em>e</em>)</span>, both gives the relation between a <em>sample</em> and a <em>gene</em>.</p>
<p>In this work it is used an innovative and recent approach to topic modelling, the algorithm was presented by <span class="citation" data-cites="gerlach2018network"></span> and extends the so called stochastic block models <span class="citation" data-cites="Holland1983"></span>. Topic modelling is being developed and studied to approach linguistics problems, so this algorithm was developed considering words and books as input, links represents the abundance of a word in a book. In chapter <a href="#ch:structure" data-reference-type="ref" data-reference="ch:structure">[ch:structure]</a> was evident that there are many similarities between data considered in this work and linguistics’ dataset. Referring to data used in this project <strong>samples</strong> will be the documents and <strong>genes</strong> will be the words. It is expected that topics represent some properties of samples due to the gene expression distribution in samples.</p>
<p>The ultimate goal would be to be able to separate healthy and diseased samples than separate and find well-known tumour types, then extend the actual knowledge and retrieve the tumour sub-types.</p>
<p>One of the advantages of this particular algorithm is that it is hierarchical, so it applies community detection at different layers. So the output has got different resolution, the extreme one is the separation, by definition, between samples and genes, at other layers it is possible to have few big clusters until the other extreme were the number of clusters is comparable with the number of nodes.</p>

<figure>
<img src="pictures/topic/peixioto_hierarchic.jpg" alt="Hierarchical structure" /><figcaption>Hierarchical structure</figcaption>
</figure>
<p><span id="fig:topic_peixioto_hierarchic" label="fig:topic_peixioto_hierarchic">[fig:topic_peixioto_hierarchic]</span></p>
<p>What the algorithm does is to run a sort of MonteCarlo simulation and find the best partition of the data. The probability that the hidden variables <span class="math inline"><em>θ</em></span> describe the data <span class="math inline"><em>G</em></span> <span class="math inline"><em>P</em>(<em>θ</em>|<em>G</em>)</span> can be written as a likelihood times a prior probability as <br /><span class="math display">$$P(\theta|G)=\frac{P(G|\theta)\overbrace{P(\theta)}^{prior}}{\underbrace{P(G)}_{\sum_{\theta}P(G|\theta)P(\theta)}}.$$</span><br /> It is possible to define a description length <br /><span class="math display"><em>Σ</em> =  − <em>l</em><em>n</em><em>P</em>(<em>G</em>|<em>θ</em>) − <em>l</em><em>n</em><em>P</em>(<em>θ</em>),</span><br /> so that <span class="math inline"><em>P</em>(<em>θ</em>|<em>G</em>) ∝ exp  − <em>Σ</em></span>. Moreover, the likelihood <span class="math inline"><em>P</em>(<em>G</em>|<em>θ</em>)</span>, can be written as <span class="math inline">$\frac{1}{\Omega}$</span> where <span class="math inline"><em>Ω</em></span> is the number of possibles realisations given <span class="math inline"><em>θ</em></span>. This can be represented as a microcanonical ensemble with entropy <span class="math inline"><em>S</em> = <em>L</em><em>n</em>(<em>Ω</em>)</span>. Note that <span class="math inline"><em>Σ</em> = <em>S</em> − <em>l</em><em>n</em><em>P</em>(<em>θ</em>)</span>. According to <span class="citation" data-cites="peixoto2017nonparametric"></span> entropy <span class="math inline"><em>S</em></span> can be written as <br /><span class="math display">$$S=\frac{1}{2}\Sigma_{r,s} n_rn_sH\left(\frac{e_{rs}}{n_rn_s}\right),$$</span><br /> where <span class="math inline"><em>n</em><sub><em>r</em></sub></span> is the number of nodes in block <span class="math inline"><em>r</em></span>, <span class="math inline"><em>e</em><sub><em>r</em><em>s</em></sub></span> the number of links between nodes of group <span class="math inline"><em>r</em></span> and group <span class="math inline"><em>s</em></span> and <span class="math inline"><em>H</em></span> is the Shannon entropy <span class="math inline"><em>H</em>(<em>X</em>) = <em>x</em><em>L</em><em>o</em><em>g</em><sub>2</sub>(<em>x</em>) + (1 − <em>x</em>)<em>L</em><em>o</em><em>g</em><sub>2</sub>(1 − <em>x</em>)</span>. Note that <span class="math inline"><em>S</em></span> is minimal if <span class="math inline">$\frac{e_{rs}}{n_rn_s}$</span> is close to zero, <span class="math inline"><em>r</em></span> and <span class="math inline"><em>s</em></span> are two completely separated blocks or if it is close to <span class="math inline">1</span>, <span class="math inline"><em>r</em></span> and <span class="math inline"><em>s</em></span> are groups with many connections; this allows to find groups with nodes very disconnected or topic and clusters with a lot of connections. The algorithm tries to minimise <span class="math inline"><em>S</em></span>, so that <span class="math inline"><em>Σ</em></span> is minimised, so <span class="math inline">exp  − <em>Σ</em></span> is maximised, but this is <span class="math inline"><em>P</em>(<em>θ</em>|<em>G</em>)</span> that is the required probability to maximise.</p>
<p>The MonteCarlo works in a few steps:</p>
<ul class="incremental">
<li><p>a node <span class="math inline"><em>i</em></span> is chosen</p></li>
<li><p>the group of <span class="math inline"><em>i</em></span> is called <span class="math inline"><em>r</em></span></p></li>
<li><p>a node <span class="math inline"><em>j</em></span> is chosen from <span class="math inline"><em>i</em></span>’s neighbours, the group of <span class="math inline"><em>j</em></span> is called <span class="math inline"><em>t</em></span></p></li>
<li><p>a random group <span class="math inline"><em>s</em></span> is selected</p></li>
<li><p>move of node <span class="math inline"><em>i</em></span> to group <span class="math inline"><em>s</em></span> is accepted with probability <span class="math inline">$P(r\to s|t)=\frac{e_{ts}+\epsilon}{e_t+\epsilon B}$</span></p></li>
<li><p>if <span class="math inline"><em>s</em></span> is not accepted, a random edge <span class="math inline"><em>e</em></span> is chosen from group <span class="math inline"><em>t</em></span> and node <span class="math inline"><em>i</em></span> is assigned to the endpoint of <span class="math inline"><em>e</em></span> which is not in <span class="math inline"><em>t</em></span></p></li>
</ul>
<p>in figure <a href="#fig:topic_pixioto_move" data-reference-type="ref" data-reference="fig:topic_pixioto_move">[fig:topic_pixioto_move]</a> an example of these steps.</p>

<figure>
<img src="pictures/topic/peixioto_move.jpg" alt="Left: Local neighbourhood of node i belonging to block r, and a randomly chosen neighbour j  belonging to block t.  Right: Block multi graph, indicating the number of edges between blocks, represented as the edge thickness.  In this example, the attempted move bi \to s is made with a larger probability than either bi \to u or bi \to r (no movement), since e_{ts}&gt;e_{tu} and e_{ts}&gt;e_{tr}." /><figcaption>Left: Local neighbourhood of node <span class="math inline"><em>i</em></span> belonging to block <span class="math inline"><em>r</em></span>, and a randomly chosen neighbour <span class="math inline"><em>j</em></span>  belonging to block <span class="math inline"><em>t</em></span>.  Right: Block multi graph, indicating the number of edges between blocks, represented as the edge thickness.  In this example, the attempted move <span class="math inline"><em>b</em><em>i</em> → <em>s</em></span> is made with a larger probability than either <span class="math inline"><em>b</em><em>i</em> → <em>u</em></span> or <span class="math inline"><em>b</em><em>i</em> → <em>r</em></span> (no movement), since <span class="math inline"><em>e</em><sub><em>t</em><em>s</em></sub> &gt; <em>e</em><sub><em>t</em><em>u</em></sub></span> and <span class="math inline"><em>e</em><sub><em>t</em><em>s</em></sub> &gt; <em>e</em><sub><em>t</em><em>r</em></sub></span>.</figcaption>
</figure>
<p><span id="fig:topic_pixioto_move" label="fig:topic_pixioto_move">[fig:topic_pixioto_move]</span></p>
<p>Once the model run it is possible to estimate the probability distribution of words inside a topic <br /><span class="math display">$$P(w|t_w)=\frac{\text{\# of edges on $w$ to $t_w$}}{\text{\# of edges on $t_w$}}$$</span><br /> and the topic distribution inside a document <br /><span class="math display">$$P(t_w|d)=\frac{\text{\# of edges on $d$ from $t_w$}}{\text{\# of edges on $d$}}$$</span><br /> In the case of overlapping partitions, the presence of a word in a topic is not trivial and can be estimated as <br /><span class="math display">$$P(t_w|w)=\frac{\text{\# of edges on $w$ to $t_w$}}{\text{\# of edges on $w$}}$$</span><br /> or the presence of a document in a cluster <br /><span class="math display">$$P(t_d|d)=\frac{\text{\# of edges on $d$ to $t_d$}}{\text{\# of edges on $d$}}$$</span><br /></p>
<p>See appendix <a href="#app:hsbm" data-reference-type="ref" data-reference="app:hsbm">[app:hsbm]</a> for detailed analysis of the math behind the algorithm and <a href="https://cloud.docker.com/repository/docker/fvalle01/hsbm" class="uri">https://cloud.docker.com/repository/docker/fvalle01/hsbm</a> for the extension of <span class="citation" data-cites="gerlach2018network"></span> to non linguistics component systems datasets.</p>
<h2 id="metrics-and-benchmarks">Metrics and benchmarks</h2>
<p>Before running topic modelling, it is useful to define some metrics to test and benchmark the model.</p>
<p>Looking at the cluster side of the network, the outputs are sets of samples, the clusters. One can state the model works if all, or at least the majority, of samples in the same cluster share some property. Here the tissue is considered as property.</p>
<p>Note that this work’s model is a non supervised one, but a ground truth is available from metadata. So every sample has a certain probability to have a certain property (the true tissue label), let’s call this <span class="math inline"><em>P</em>(<em>C</em>)</span> and a certain probability of being in a cluster (model’s output), let’s call this <span class="math inline"><em>P</em>(<em>K</em>)</span>.</p>
<p>It is possible to define some quantities, the homogeneity <br /><span class="math display">$$\label{eq:homogeneity}
    h=1-\frac{H(C|K)}{H(C)}$$</span><br /> defining the entropy <br /><span class="math display">$$\label{eq:hck}
    H(C|K)=\sum_{c\in \mathrm{tissues},\\ k \in \mathrm{clusters}}\frac{n_{c k}}{N}Log\left(\frac{n_{c k}}{n_k}\right)$$</span><br /> where <span class="math inline"><em>n</em><sub><em>c</em><em>k</em></sub></span> is the number of nodes of type <span class="math inline"><em>c</em></span> in cluster <span class="math inline"><em>k</em></span>, <span class="math inline"><em>N</em></span> the number of nodes and <span class="math inline"><em>n</em><sub><em>k</em></sub></span> the number of nodes in cluster <span class="math inline"><em>k</em></span>. It is evident that if all nodes inside cluster <span class="math inline"><em>k</em></span> are of the same type <span class="math inline"><em>c</em></span> <span class="math inline"><em>n</em><sub><em>c</em><em>k</em></sub> = <em>n</em><sub><em>k</em></sub></span>, <span class="math inline"><em>H</em>(<em>C</em>|<em>K</em>) = 0</span> and <span class="math inline"><em>h</em> = 1</span>, it is actually a complete homogeneous situation.</p>
<p>Another quantity can be defined and it is completeness: <br /><span class="math display">$$\label{eq:completness}
    c=1-\frac{H(K|C)}{H(K)},$$</span><br /> <span class="math inline"><em>H</em>(<em>K</em>|<em>C</em>)</span> is defined in the same way as <a href="#eq:hck" data-reference-type="ref" data-reference="eq:hck">[eq:hck]</a>. Completeness measures if all nodes of the same type are in the same cluster.</p>
<p>Ideally one wants a method which output is both homogeneous and complete. So it is possible to define the V-measure, which is the harmonic average of the two: <br /><span class="math display">$$\label{eq:mutualinformation}
    \mathrm{V-measure}=2\frac{h c}{h + c},$$</span><br /> which is actually the normalized mutual information between <span class="math inline"><em>P</em>(<em>C</em>)</span> and <span class="math inline"><em>P</em>(<em>K</em>)</span> <span class="citation" data-cites="rosenberg2007v"></span>.</p>
<p>In the next sections will be studied also the maximum fraction of label in the same cluster <span class="math inline">$max_{c\in k}\frac{n_{c k}}{n_k}$</span>. Also the number of different labels in the same cluster will be studied.</p>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/metric_scores_primarysite.pdf" /><figcaption>Scores across hierarchy. The mutual information is the harmonic average between homogeneity and completeness</figcaption>
</figure>
<p><span id="fig:topic/metric_scores_primarysite" label="fig:topic/metric_scores_primarysite">[fig:topic/metric_scores_primarysite]</span></p>

<h3 id="hierarchical-clustering">Hierarchical clustering</h3>


<p>Hierarchical clustering is a general family of clustering algorithms that build nested clusters by merging or splitting them successively. This hierarchy of clusters is represented as a tree (or dendrogram). The root of the tree is the unique cluster that gathers all the samples, the leaves being the clusters with only one sample. See the Wikipedia page for more details.</p>
<p>The AgglomerativeClustering object performs a hierarchical clustering using a bottom up approach: each observation starts in its own cluster, and clusters are successively merged together. The linkage criteria determines the metric used for the merge strategy:</p>
<p>Ward minimizes the sum of squared differences within all clusters. It is a variance-minimizing approach and in this sense is similar to the k-means objective function but tackled with an agglomerative hierarchical approach. Maximum or complete linkage minimizes the maximum distance between observations of pairs of clusters. Average linkage minimizes the average of the distances between all observations of pairs of clusters. Single linkage minimizes the distance between the closest observations of pairs of clusters. AgglomerativeClustering can also scale to a large number of samples when it is used jointly with a connectivity matrix but is computationally expensive when no connectivity constraints are added between samples: it considers at each step all the possible merges.</p>
<pre style="mypython"><code>from sklearn.cluster import AgglomerativeClustering
AgglomerativeClustering(
    affinity=&#39;euclidean&#39;,
    compute_full_tree=&#39;auto&#39;,
    linkage=&#39;ward&#39;,
    n_clusters=x,
    )</code></pre>
<h3 id="sec:lda">LDA</h3>

<p>As in  <span class="citation" data-cites="Zhou2016"></span> <br /><span class="math display">$$\label{eq:lda}
P(w, z,\beta, \theta| \alpha, \eta)=\prod_n^{N_d} P(w|z,\beta)P(z|\theta)\prod_k^KP(\beta|\eta)\prod_d^N P(\theta | \alpha)$$</span><br /></p>

<p><img src="pictures/topic/LDA.jpeg" title="fig:" alt="LAD scheme" /> <span id="fig:LDA" label="fig:LDA">[fig:LDA]</span></p>
<p>where</p>
<ul class="incremental">
<li><p><span class="math inline"><em>N</em></span> number of documents</p></li>
<li><p><span class="math inline"><em>K</em></span> number of topics</p></li>
<li><p><span class="math inline"><em>w</em></span> words</p></li>
<li><p><span class="math inline"><em>N</em><sub><em>d</em></sub></span> number of words in document d</p></li>
<li><p><span class="math inline"><em>η</em></span> and <span class="math inline"><em>α</em></span> are parameters of the model</p></li>
</ul>
<p>in <a href="#eq:lda" data-reference-type="ref" data-reference="eq:lda">[eq:lda]</a> <span class="math inline"><em>P</em>(<em>θ</em>|<em>α</em>)</span> and <span class="math inline"><em>P</em>(<em>β</em>|<em>η</em>)</span> are Dirichlet distributions the outputs are the topic distribution in documents <span class="math inline"><em>P</em>(<em>z</em>|<em>d</em>)</span> and the word distribution in topics <span class="math inline"><em>P</em>(<em>w</em>|<em>z</em>)</span></p>
<h2 id="pre-process">Pre-process</h2>
<p>To make the algorithm faster, could be interesting to do a pre-processing of the data. Vary approaches were tested, all of them involving the quantities defined in <a href="#ch:structure" data-reference-type="ref" data-reference="ch:structure">[ch:structure]</a>. The goal is to identify components which are able to best separate the realisations.</p>
<h5 id="low-occurrence-genes">Low occurrence genes</h5>
<p>were selected firstly to make topic modelling. A <span class="math inline">0.5</span> threshold was set. This method select genes that appears (have expression greater than zero) only in less than half samples. This doesn’t consider genes that appear everywhere (with occurrence <span class="math inline"> ≃ 1</span>) but changes their behaviour across realisations.</p>
<h5 id="tf-idf-term-frequencyinverse-document-frequency">tf-idf (term frequency–inverse document frequency)</h5>
<p>should help. This approach doesn’t consider values, but a transformed version <br /><span class="math display">$$n^{new}_{ij}=\frac{n_{i j}}{M_j}\times \left(1-Log\left(o_i\right)\right)$$</span><br /> which increases the importance of components with small occurrence <span class="math inline"><em>o</em><sub><em>i</em></sub></span>. This approach doesn’t actually select components, which is still an issue.</p>
<h5 id="highly-variable">Highly variable</h5>
<p>genes can be selected. This is done using the <span class="math inline"><em>C</em><em>V</em><sup>2</sup></span> analysis from .</p>

<figure>
<img src="pictures/topic/cvmean_oversigma.png" alt="Highly variable genes" /><figcaption>Highly variable genes</figcaption>
</figure>
<p><span id="fig:topic/cvmean_oversigma" label="fig:topic/cvmean_oversigma">[fig:topic/cvmean_oversigma]</span></p>
<p>Plotting the coefficient of variation versus the mean for each component reveals which components have higher variance with respect to components which, on average, have a similar behaviour. Binned averages and variances were estimated, and only genes with a <span class="math inline"><em>C</em><em>V</em><sup>2</sup></span> over a <span class="math inline"><em>σ</em></span> greater than the bin’s mean were considered.</p>
<h5 id="distance-from-boundaries">Distance from boundaries</h5>
<p>can be a similar and alternative method to select highly variable genes.</p>

<figure>
<img src="pictures/topic/cvmean_oversampling.png" alt="Genes distant from the boundaries" /><figcaption>Genes distant from the boundaries</figcaption>
</figure>
<p><span id="fig:topic/cvmean_oversampling" label="fig:topic/cvmean_oversampling">[fig:topic/cvmean_oversampling]</span></p>
<p>The distribution as discussed in have a Poisson-like and a Taylor-like boundaries. So can be considered only components that are the most distant from these boundaries.</p>
<p>Using the last two approaches got the point and actually help topic modelling to succeed.</p>

<h2 id="run">Run</h2>
<h3 id="run-on-gene-tissues-expression-dataset">Run on Gene Tissues Expression dataset</h3>
<p>Once the model was tuned and adapted to RNA-Sequencing data, it was run on a subset of the GTEx dataset. A subset was chosen randomly in order to reduce the computing time needed. The analysis hereby described took about 2 days to be run on a 16 core CPU, 100GB memory facility. The great amount of memory is needed to temporary store the network configuration at each step of the Monte Carlo simulation.</p>
<p>First of all to rapidly have information about the interest of the oncoming result the metric above described were considered. In figure <a href="#fig:topic/gtex/oversigma_10tissue/metric_scores" data-reference-type="ref" data-reference="fig:topic/gtex/oversigma_10tissue/metric_scores">[fig:topic/gtex/oversigma_10tissue/metric_scores]</a> it is represented the V-measure score versus the number of clusters found at different layers.</p>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/metric_scores.pdf" /><figcaption>Scores across the hierarchy. The primary site and secondary site labels are compared.</figcaption>
</figure>
<p><span id="fig:topic/gtex/oversigma_10tissue/metric_scores" label="fig:topic/gtex/oversigma_10tissue/metric_scores">[fig:topic/gtex/oversigma_10tissue/metric_scores]</span></p>
<p>The result is quite good, the maximum score is over <span class="math inline">0.8</span>. Considering that, for example, <span class="citation" data-cites="Farver2018"></span> obtained a similar score analysing similar dataset considering just homogeneity, this can be considered a quite good result. A second interesting fact is that both the tissue label (primary site) and the sub-tissue label (secondary site) obtain such a good score, moreover the the secondary site score’s peak is at a higher number of clusters coherently with the fact that there is a greater number of sub tissue labels. This score can be useful to extract the correct level of the hierarchy the consequent analysis should be made on.</p>
<p>In figure <a href="#fig:topic/gtex/oversigma_10tissue/bipartite_rebuild" data-reference-type="ref" data-reference="fig:topic/gtex/oversigma_10tissue/bipartite_rebuild">[fig:topic/gtex/oversigma_10tissue/bipartite_rebuild]</a> the relation between the clusters at different layers it is evident.</p>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/bipartite_rebuild.pdf" /><figcaption>Hierarchy of the files’ nodes.</figcaption>
</figure>
<p><span id="fig:topic/gtex/oversigma_10tissue/bipartite_rebuild" label="fig:topic/gtex/oversigma_10tissue/bipartite_rebuild">[fig:topic/gtex/oversigma_10tissue/bipartite_rebuild]</span></p>

<p>In figure <a href="#fig:topic/gtex/oversigma_10tissue/clustercomposition_l3_primary_site" data-reference-type="ref" data-reference="fig:topic/gtex/oversigma_10tissue/clustercomposition_l3_primary_site">[fig:topic/gtex/oversigma_10tissue/clustercomposition_l3_primary_site]</a> each column is a cluster and each colour is a tissue of the dataset. It is evident that the majority of the tissue are identified: the first, second, fifth, sixth, eighth and tenth columns are fully and uniformly coloured of the same colour. These correspond to an identification of brain, blood, lung, testis and bladder.</p>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/clustercomposition_l3_primary_site.pdf" /><figcaption>Clusters composition at the level of the hierarchy with higher score. Each column is a cluster, each colour is a label.</figcaption>
</figure>
<p><span id="fig:topic/gtex/oversigma_10tissue/clustercomposition_l3_primary_site" label="fig:topic/gtex/oversigma_10tissue/clustercomposition_l3_primary_site">[fig:topic/gtex/oversigma_10tissue/clustercomposition_l3_primary_site]</span></p>
<p>A normalised representation of the same clusters the result is still quite interesting and the homogeneity of the clusters is more evident.</p>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/fraction_clustercomposition_l3_primary_site.pdf" /><figcaption>Normalised composition of clusters.</figcaption>
</figure>
<p><span id="fig:topic/gtex/oversigma_10tissue/fraction_clustercomposition_l3_primary_site" label="fig:topic/gtex/oversigma_10tissue/fraction_clustercomposition_l3_primary_site">[fig:topic/gtex/oversigma_10tissue/fraction_clustercomposition_l3_primary_site]</span></p>
<p>Going deeper in the hierarchy and looking at a layer with more cluster the result, shown in figure <a href="#fig:topic/gtex/oversigma_10tissue/fraction_clustercomposition_l2_primary_site" data-reference-type="ref" data-reference="fig:topic/gtex/oversigma_10tissue/fraction_clustercomposition_l2_primary_site">[fig:topic/gtex/oversigma_10tissue/fraction_clustercomposition_l2_primary_site]</a>, demonstrates that at this point all the tissues are separated and each cluster is full of nodes sharing the same tissue.</p>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/fraction_clustercomposition_l2_primary_site.pdf" /><figcaption>Normalised composition of clusters at a deeper level.</figcaption>
</figure>
<p><span id="fig:topic/gtex/oversigma_10tissue/fraction_clustercomposition_l2_primary_site" label="fig:topic/gtex/oversigma_10tissue/fraction_clustercomposition_l2_primary_site">[fig:topic/gtex/oversigma_10tissue/fraction_clustercomposition_l2_primary_site]</span></p>
<p>Even looking at sub-tissues the results is quite good. It is not always easy to separate all the sub-parts of the brain, nevertheless, the cerebellum is well identified (column 13) and blood is distinguished in whole blood (columns 1-4) and lymphocytes (column 10).</p>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/fraction_clustercomposition_l2_secondary_site.pdf" /><figcaption>Normalised composition of clusters with respect to the secondary site sub-tissue labels.</figcaption>
</figure>
<p><span id="fig:topic/gtex/oversigma_10tissue/fraction_clustercomposition_l2_secondary_site" label="fig:topic/gtex/oversigma_10tissue/fraction_clustercomposition_l2_secondary_site">[fig:topic/gtex/oversigma_10tissue/fraction_clustercomposition_l2_secondary_site]</span></p>
<h3 id="shuffling">Shuffling</h3>
<p>A null model of cluster composition is necessary In order to be able to state that a result is better than expected. This was done by doing the same analysis but reshuffling the labels of the nodes. Doing so the number of clusters and the cluster sizes are maintained. In figure <a href="#fig:topic/gtex/oversigma_10tissue/shuffledclustercomposition_l3_primary_site" data-reference-type="ref" data-reference="fig:topic/gtex/oversigma_10tissue/shuffledclustercomposition_l3_primary_site">[fig:topic/gtex/oversigma_10tissue/shuffledclustercomposition_l3_primary_site]</a> an example of clustering with random labels, it is evident that all clusters have similar and homogeneous composition. Note that not every tissue has the same number of samples, so, for example, blood is more represented than other tissues.</p>

<figure>
<img src="pictures/topic/gtex/oversigma_10tissue/shuffledclustercomposition_l3_primary_site" alt="Example of visualization of clusters with reshuffled labels." /><figcaption>Example of visualization of clusters with reshuffled labels.</figcaption>
</figure>
<p><span id="fig:topic/gtex/oversigma_10tissue/shuffledclustercomposition_l3_primary_site" label="fig:topic/gtex/oversigma_10tissue/shuffledclustercomposition_l3_primary_site">[fig:topic/gtex/oversigma_10tissue/shuffledclustercomposition_l3_primary_site]</span></p>
<p>All the results described in the previous pictures are quite qualitative. To have a more objective and mathematical measure of the success of the algorithm it is possible to measure the fraction of the most representative label in each cluster <span class="math inline"><em>k</em></span> <br /><span class="math display">$$max_{l\in labels}\left(\frac{n_{l k}}{n_k}\right)$$</span><br /> with <span class="math inline"><em>n</em><sub><em>l</em><em>k</em></sub></span> is the numbers of nodes labelled <span class="math inline"><em>l</em></span> in cluster <span class="math inline"><em>k</em></span> and <span class="math inline"><em>n</em><sub><em>k</em></sub></span> is the number of nodes in cluster <span class="math inline"><em>k</em></span>. This is represented in figure <a href="#fig:gtex/oversigma_10tissue/shuffledcluster_maximum_l2_primary_site" data-reference-type="ref" data-reference="fig:gtex/oversigma_10tissue/shuffledcluster_maximum_l2_primary_site">[fig:gtex/oversigma_10tissue/shuffledcluster_maximum_l2_primary_site]</a> for the level where the V-measure is maximized (best results are expected here). In figure <a href="#fig:gtex/oversigma_10tissue/shuffledcluster_maximum_l2_primary_site" data-reference-type="ref" data-reference="fig:gtex/oversigma_10tissue/shuffledcluster_maximum_l2_primary_site">[fig:gtex/oversigma_10tissue/shuffledcluster_maximum_l2_primary_site]</a> on the left is shown the most representative label fraction versus for each cluster, on the right the histograms of the same quantity. It is evident that models’ clusters are very homogeneous with the majority of cluster with almost <span class="math inline">100%</span> of the same tissue. It is also clear that reshuffling the labels the result is very different and so the models behave better than expected.</p>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/shuffledcluster_maximum_l2_primary_site.pdf" /><figcaption>Most representative label versus cluster size.</figcaption>
</figure>
<p><span id="fig:gtex/oversigma_10tissue/shuffledcluster_maximum_l2_primary_site" label="fig:gtex/oversigma_10tissue/shuffledcluster_maximum_l2_primary_site">[fig:gtex/oversigma_10tissue/shuffledcluster_maximum_l2_primary_site]</span></p>
<p>In figure <a href="#fig:topic/gtex/oversigma_10tissue/shuffledcluster_maximum*" data-reference-type="ref" data-reference="fig:topic/gtex/oversigma_10tissue/shuffledcluster_maximum*">[fig:topic/gtex/oversigma_10tissue/shuffledcluster_maximum*]</a> the same analysis is done for every level of the hierarchy. It is interesting to notice that at deeper levels (upper left in the figure) the random reshuffling and the real labels have the same behaviour. This is due to the fact that at this level clusters are very small and so it is easier to pick up nodes with the same level (in the extreme case of a cluster with size 1 it is always full with the same label). This shows that the deeper level it is not interesting, results are the same with random labels; moreover the reshuffling null model it is good to show up eventual biases due to small cluster sizes.</p>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/shuffledcluster_maximum_l0_primary_site.pdf" /><figcaption>The fraction of the most representative label in all clusters for different levels of the hierarchy. From upper left the deeper layer than down right the upper one.</figcaption>
</figure>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/shuffledcluster_maximum_l1_primary_site.pdf" /><figcaption>The fraction of the most representative label in all clusters for different levels of the hierarchy. From upper left the deeper layer than down right the upper one.</figcaption>
</figure>
<p><br />
</p>
<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/shuffledcluster_maximum_l2_primary_site.pdf" /><figcaption>The fraction of the most representative label in all clusters for different levels of the hierarchy. From upper left the deeper layer than down right the upper one.</figcaption>
</figure>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/shuffledcluster_maximum_l3_primary_site.pdf" /><figcaption>The fraction of the most representative label in all clusters for different levels of the hierarchy. From upper left the deeper layer than down right the upper one.</figcaption>
</figure>
<p><span id="fig:topic/gtex/oversigma_10tissue/shuffledcluster_maximum*" label="fig:topic/gtex/oversigma_10tissue/shuffledcluster_maximum*">[fig:topic/gtex/oversigma_10tissue/shuffledcluster_maximum*]</span></p>
<p>A similar analysis can be made considering not just the number of the cluster but the cluster size, this is shown in figure <a href="#fig:topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l3_primary_site" data-reference-type="ref" data-reference="fig:topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l3_primary_site">[fig:topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l3_primary_site]</a>. It is interesting to notice that the shuffle null model and the real labels clusters are evidently different, so there must be some kind of signal. It is clear that the model is able to output big clusters full of the same label.</p>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l3_primary_site.pdf" /><figcaption>Fraction of most representative label versus cluster size.</figcaption>
</figure>
<p><span id="fig:topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l3_primary_site" label="fig:topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l3_primary_site">[fig:topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l3_primary_site]</span></p>
<p>In figure <a href="#fig:topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l*" data-reference-type="ref" data-reference="fig:topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l*">[fig:topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l*]</a> the same analysis for all the levels of the hierarchy. It is interesting to see how going up in the hierarchy the two signals become different, as shown before the deeper layer (upper left in the image) is not different from null model and so it is not interesting.</p>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l0_primary_site.pdf" /><figcaption>Fraction of most representative label versus cluster size across the hierarchy. From upper left the deeper layer than downright the upper one.</figcaption>
</figure>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l1_primary_site.pdf" /><figcaption>Fraction of most representative label versus cluster size across the hierarchy. From upper left the deeper layer than downright the upper one.</figcaption>
</figure>
<p><br />
</p>
<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l2_primary_site.pdf" /><figcaption>Fraction of most representative label versus cluster size across the hierarchy. From upper left the deeper layer than downright the upper one.</figcaption>
</figure>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l3_primary_site.pdf" /><figcaption>Fraction of most representative label versus cluster size across the hierarchy. From upper left the deeper layer than downright the upper one.</figcaption>
</figure>
<p><span id="fig:topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l*" label="fig:topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l*">[fig:topic/gtex/oversigma_10tissue/shuffledclusterhomosize_l*]</span></p>
<p>At this point to deepen investigate the structure of the clusters it can be interesting to study how many labels are present in each cluster. In fact, the fraction of most represented label defined above carries no information of what happens to the remaining labels. For example, if one cluster is composed of <span class="math inline">80%</span> by label <strong>A</strong> and <span class="math inline">20%</span> by label <strong>B</strong> and another cluster is composed <span class="math inline">80%</span> by label <strong>A</strong>, <span class="math inline">10%</span> by label <strong>B</strong> and <span class="math inline">10%</span> by label <strong>C</strong> they have both a fraction of maximum representative label <span class="math inline">80%</span> but the second in this example is more heterogeneous. Counting the number of different labels in each cluster can reveal this sort of effects. In figure <a href="#fig:topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l3_primary_site" data-reference-type="ref" data-reference="fig:topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l3_primary_site">[fig:topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l3_primary_site]</a> it is represented the number of different labels versus cluster size. It is evident that the reshuffling case is quite different from the real one, almost every cluster in the null model has got every label. It is interesting to notice that the model outputs even big cluster with one label.</p>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l3_primary_site.pdf" /><figcaption>The number of different labels in each cluster versus cluster size.</figcaption>
</figure>
<p><span id="fig:topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l3_primary_site" label="fig:topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l3_primary_site">[fig:topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l3_primary_site]</span></p>
<p>In figure <a href="#fig:topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l*" data-reference-type="ref" data-reference="fig:topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l*">[fig:topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l*]</a> the same analysis for all the layer of the hierarchy. Even here the deeper level does not differ from the null model. Nevertheless in layers with higher V-measure score there is a strong signal that the reshuffling model is quite different from the model’s output.</p>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l0_primary_site.pdf" /><figcaption>Number of different labels in each cluster versus cluster size. From upper left the deeper layer than downright the upper one.</figcaption>
</figure>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l1_primary_site.pdf" /><figcaption>Number of different labels in each cluster versus cluster size. From upper left the deeper layer than downright the upper one.</figcaption>
</figure>
<p><br />
</p>
<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l2_primary_site.pdf" /><figcaption>Number of different labels in each cluster versus cluster size. From upper left the deeper layer than downright the upper one.</figcaption>
</figure>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l3_primary_site.pdf" /><figcaption>Number of different labels in each cluster versus cluster size. From upper left the deeper layer than downright the upper one.</figcaption>
</figure>
<p><span id="fig:topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l*" label="fig:topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l*">[fig:topic/gtex/oversigma_10tissue/shuffledcluster_shuffle_label_size_l*]</span></p>
<p>Having constructed the null model it is possible to estimate the V-measure score also for the null model. The results are reported in figure <a href="#fig:topic/gtex/oversigma_10tissue/metric_scores_shuffle" data-reference-type="ref" data-reference="fig:topic/gtex/oversigma_10tissue/metric_scores_shuffle">[fig:topic/gtex/oversigma_10tissue/metric_scores_shuffle]</a>. Moreover remembering the V-measure or normalized mutual information defined in <a href="#eq:mutualinformation" data-reference-type="ref" data-reference="eq:mutualinformation">[eq:mutualinformation]</a> it is possible to estimate a mixed score which considers the homogeneity of primary site and the completeness of secondary site, doing so the score goes up if going deeper in the hierarchy the model makes more cluster with the same tissue but separates sub tissues. It is not a big deal if one loses completeness regarding tissues (the model separates one big cluster full with the same label into two small ones) but gain information at the next magnification. This becomes clear if one looks at the big blood cluster that in the next level of the hierarchy is separated into two clusters of blood, one of whole blood and one of lymphocytes. The result is that this mixed score is the highest one.</p>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/metric_scores_shuffle.pdf" /><figcaption>Scores across the hierarchy. The scored is compared with some random labels. In blue the score for the primary site labels, in red for the secondary site labels, in yellow the shuffled labels, in green the mixed score with primary homogeneity and secondary completeness.</figcaption>
</figure>
<p><span id="fig:topic/gtex/oversigma_10tissue/metric_scores_shuffle" label="fig:topic/gtex/oversigma_10tissue/metric_scores_shuffle">[fig:topic/gtex/oversigma_10tissue/metric_scores_shuffle]</span></p>

<h3 id="standard-algorithms">Standard algorithms</h3>
<p>At this point was verified that the model has got interesting output, it reaches high scores and has got a strong signal against null model, at least at some levels of the hierarchy. It is now interesting to compare it with standard and well-known similar algorithms. First of all a comparison is made with hierarchical clustering. This is done using the standard scipy <span class="citation" data-cites="jones2014scipy"></span> package, the metrics used was the euclidean one and the linkage method was set to Ward. This is quite fast, it needs a couple of minutes on a dual core, 8GB memory machine. In figure <a href="#fig:topic/gtex/oversigma_10tissue/metric_scores_hier" data-reference-type="ref" data-reference="fig:topic/gtex/oversigma_10tissue/metric_scores_hier">[fig:topic/gtex/oversigma_10tissue/metric_scores_hier]</a> the comparison between this scores, the hierarchical algorithm performs worse than hierarchical stochastic block model and as highly expected better than the random model.</p>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/metric_scores_hier.pdf" /><figcaption>Scores across hierarchy. The scored is compared with some random labels</figcaption>
</figure>
<p><span id="fig:topic/gtex/oversigma_10tissue/metric_scores_hier" label="fig:topic/gtex/oversigma_10tissue/metric_scores_hier">[fig:topic/gtex/oversigma_10tissue/metric_scores_hier]</span></p>
<p>Another very used and well-studied algorithm is Latent Dirichlet Allocation briefly described in <a href="#sec:lda" data-reference-type="ref" data-reference="sec:lda">1.1.2</a>. Running LDA in standard scipy package is quite fast and is comparable with hierarchical clustering in terms of CPU time. Note that once LDA package extracts the topics, it is necessary to define some clusters, to do so a standard Agglomerative clustering approach was used, the distance was set to euclidean and the linkage to Ward. In figure <a href="#fig:topic/gtex/oversigma_10tissue/metric_scores_all" data-reference-type="ref" data-reference="fig:topic/gtex/oversigma_10tissue/metric_scores_all">[fig:topic/gtex/oversigma_10tissue/metric_scores_all]</a> are reported the V-measure score for all the algorithms described until this point. What is clear is that the hierarchical Stochastic Block Model performs better than all the others, LDA gain a little worst score and hierarchical clustering is the worst of the three. As highly expected all models are quite different than random. The fact that hSBM and LDA have higher scores suggests that a topic model approach can be very useful in this kind of problems.</p>

<figure>
<embed src="pictures/topic/gtex/oversigma_10tissue/metric_scores_all.pdf" /><figcaption>Scores across hierarchy. The scored is compared with some random labels</figcaption>
</figure>
<p><span id="fig:topic/gtex/oversigma_10tissue/metric_scores_all" label="fig:topic/gtex/oversigma_10tissue/metric_scores_all">[fig:topic/gtex/oversigma_10tissue/metric_scores_all]</span></p>
<p>Note that LDA and hierarchical cluster models were not fine tuned and default parameters were used. Maybe a fine tuning of this packages can lead to better and more satisfying results. This analysis, considering that the comparison was made with hierarchical Stochastic Block Model which is non-parametric and needs no setting, was done without any fine tuning and standard parameter were set. The fact reveals another good point of hSBM, it extracts not only better clusters, but also the parameters necessary to this kind of model.</p>
<h3 id="topics">Topics</h3>
<p>The analysis up to this point considered only one of the two sides of the bipartite network, in fact nothing was told about the genes (words in topic models). Not less the model output some clusters of genes. From now on I’ll refer to these clusters of genes as topics.</p>
<p>If one has got a set of genes in order to catch any important information and discover if there is any biological meaning behind it, it is possible to perform an enrichment test. Enrichment analysis checks whether an input set of genes significantly overlaps with annotated gene sets. In this work tests were made using Gene Set Enrichment Analysis <span class="citation" data-cites="subramanian2005gene"></span> python tool <span class="citation" data-cites="Kuleshov2016"></span>, which performs a Fisher exact test (hypergeometric test), the Benjamini-Hochberg corrected P-values is reported. Genes’ annotation terms were searched in the following sets:</p>
<ul class="incremental">
<li><p>GO Molecular Function 2018</p></li>
<li><p>GO Biological Process 2018</p></li>
<li><p>GO Cellular Component 2018</p></li>
<li><p>Human Phenotype Ontology</p></li>
<li><p>Tissue Protein Expression from Human Proteome Map</p></li>
<li><p>KEGG 2019 Human</p></li>
<li><p>NCI-60 Cancer Cell Lines</p></li>
<li><p>GTEx Tissue Sample Gene Expression Profiles up</p></li>
<li><p>GTEx Tissue Sample Gene Expression Profiles down,</p></li>
</ul>
<p>in particular the two latter contains annotation specific for GTEx dataset <span class="citation" data-cites="Ardlie2015"></span>.</p>
<p>In tables <a href="#topic/enrich/pancreas" data-reference-type="ref" data-reference="topic/enrich/pancreas">[topic/enrich/pancreas]</a>,  <a href="#topic/enrich/brain" data-reference-type="ref" data-reference="topic/enrich/brain">[topic/enrich/brain]</a> and  <a href="#topic/enrich/blood" data-reference-type="ref" data-reference="topic/enrich/blood">[topic/enrich/blood]</a> are reported examples of enrichment test results for topics output by hSBM. On the results is put a P-value cut at <span class="math inline">0.05</span> and terms are sorted by adjusted P-value.</p>

<table>
<caption>Enrichment test of a topic. It is clear the enrichment for pancreas related gene sets.<span label="tab:topic/enrich/pancreas"></span></caption>
<thead>
<tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: center;"></th>
<th style="text-align: right;">Gene set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">pancreas male 60-69 years</td>
<td style="text-align: center;">1E-19</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">pancreas female 40-49 years</td>
<td style="text-align: center;">3E-19</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pancreas male 40-49 years</td>
<td style="text-align: center;">5E-19</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">pancreas male 30-39 years</td>
<td style="text-align: center;">1E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pancreas female 20-29 years</td>
<td style="text-align: center;">1E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">pancreas male 50-59 years</td>
<td style="text-align: center;">1E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pancreas female 30-39 years</td>
<td style="text-align: center;">1E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">pancreas male 50-59 years</td>
<td style="text-align: center;">2E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pancreas male 40-49 years</td>
<td style="text-align: center;">2E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">pancreas male 30-39 years</td>
<td style="text-align: center;">2E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pancreas male 50-59 years</td>
<td style="text-align: center;">2E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">pancreas female 20-29 years</td>
<td style="text-align: center;">2E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pancreas male 40-49 years</td>
<td style="text-align: center;">3E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">pancreas female 50-59 years</td>
<td style="text-align: center;">4E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pancreas male 50-59 years</td>
<td style="text-align: center;">4E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">pancreas male 50-59 years</td>
<td style="text-align: center;">4E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pancreas female 60-69 years</td>
<td style="text-align: center;">5E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">pancreas female 50-59 years</td>
<td style="text-align: center;">5E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pancreas male 50-59 years</td>
<td style="text-align: center;">5E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">pancreas male 30-39 years</td>
<td style="text-align: center;">6E-18</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
</tbody>
</table>

<table>
<caption>Enrichment test of a topic. It is clear the enrichment for brain related gene sets.<span label="tab:topic/enrich/brain"></span></caption>
<thead>
<tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: center;"></th>
<th style="text-align: right;">Gene set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">brain female 40-49 years</td>
<td style="text-align: center;">6E-05</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">brain male 50-59 years</td>
<td style="text-align: center;">6E-05</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">brain female 60-69 years</td>
<td style="text-align: center;">6E-05</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">brain female 60-69 years</td>
<td style="text-align: center;">6E-05</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">brain female 60-69 years</td>
<td style="text-align: center;">6E-05</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">brain female 40-49 years</td>
<td style="text-align: center;">6E-05</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">brain female 40-49 years</td>
<td style="text-align: center;">6E-05</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">brain female 60-69 years</td>
<td style="text-align: center;">6E-05</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">brain male 60-69 years</td>
<td style="text-align: center;">6E-05</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">brain male 50-59 years</td>
<td style="text-align: center;">6E-05</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">brain male 50-59 years</td>
<td style="text-align: center;">6E-05</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">brain male 60-69 years</td>
<td style="text-align: center;">7E-05</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">brain male 50-59 years</td>
<td style="text-align: center;">7E-05</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">brain male 20-29 years</td>
<td style="text-align: center;">7E-05</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">brain female 60-69 years</td>
<td style="text-align: center;">8E-05</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">brain female 60-69 years</td>
<td style="text-align: center;">8E-05</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">brain female 60-69 years</td>
<td style="text-align: center;">1E-04</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">brain female 60-69 years</td>
<td style="text-align: center;">1E-04</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">brain female 60-69 years</td>
<td style="text-align: center;">1E-04</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">brain male 60-69 years</td>
<td style="text-align: center;">1E-04</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
</tbody>
</table>


<table>
<caption>Enrichment test of a topic. It is clear the enrichment for blood related gene sets.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: center;"></th>
<th style="text-align: right;">Gene set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">blood male 50-59 years</td>
<td style="text-align: center;">3E-23</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">blood male 50-59 years</td>
<td style="text-align: center;">3E-23</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blood male 40-49 years</td>
<td style="text-align: center;">3E-21</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">blood male 60-69 years</td>
<td style="text-align: center;">9E-21</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blood male 40-49 years</td>
<td style="text-align: center;">3E-20</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">blood female 60-69 years</td>
<td style="text-align: center;">4E-20</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blood male 60-69 years</td>
<td style="text-align: center;">4E-20</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">blood female 50-59 years</td>
<td style="text-align: center;">5E-20</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blood female 50-59 years</td>
<td style="text-align: center;">1E-19</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">blood male 60-69 years</td>
<td style="text-align: center;">1E-19</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blood male 60-69 years</td>
<td style="text-align: center;">1E-19</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">blood female 60-69 years</td>
<td style="text-align: center;">1E-19</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blood male 60-69 years</td>
<td style="text-align: center;">2E-19</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">blood male 50-59 years</td>
<td style="text-align: center;">2E-19</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blood female 40-49 years</td>
<td style="text-align: center;">2E-19</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">blood female 40-49 years</td>
<td style="text-align: center;">2E-19</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blood female 60-69 years</td>
<td style="text-align: center;">2E-19</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">blood male 30-39 years</td>
<td style="text-align: center;">3E-19</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blood female 50-59 years</td>
<td style="text-align: center;">5E-19</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
<tr class="even">
<td style="text-align: left;">blood female 60-69 years</td>
<td style="text-align: center;">5E-19</td>
<td style="text-align: right;">GTEx Tissue Sample Gene Expression Profiles up</td>
</tr>
</tbody>
</table>
<p><span id="tab:topic/enrich/blood" label="tab:topic/enrich/blood">[tab:topic/enrich/blood]</span></p>
<p>Test were made on the topics at the level of the hierarchy which obtained the higher V-measure score on the sample side clustering. These results are very interesting, these enrichment tests demonstrate that not only the sample side of the network is well clustered but only the topics have a non trivial meaning.</p>
<p>So also the topics are related to the tissues and somehow are tissue-specific. In the next examples the relation between the topics and the samples will be further investigated. In particular following what was done by <span class="citation" data-cites="dey2017visualizing"></span> the importance of each topic inside each sample the <span class="math inline"><em>P</em>(topic|sample)</span>.</p>
<p>Separate healthy tissues is a good exercise and a good benchmark for models, but the real goals would be to be able to classify diseased samples. In fact it is not always easy to identify and classify cancer tissues. In particular being able to separate tumour sub-types would be the ideal pursuance of this work. So let’s switch to the analysis of diseased samples.</p>

<h3 id="run-on-the-cancer-genomics-atlas">Run on The Cancer Genomics Atlas</h3>
<p>The exact same pipeline described so far ca be applied at other dataset. In this section the hSBM model is run on some samples from the TCGA. The principle is the same, but here samples comes from cancer tissues, so there must be more complexity and variability behind the data. Moreover being able to separate cancer samples is not always easy clinically and develop a method to do this can be highly interesting and useful for the scientific community <span class="citation" data-cites="Farver2018"></span>.</p>
<p>First of all let’s take a look at the V-measure scores. As shown in figure <a href="#fig:topic/tcga/metric" data-reference-type="ref" data-reference="fig:topic/tcga/metric">[fig:topic/tcga/metric]</a> the score is almost <span class="math inline">0.7</span>, which is good, but worse than the healthy GTEx scenario. In this dataset there is no a sub-tissue label as before, but a disease type cancer information is available. The disease type separation is not so good; the fact that there is no evident difference between Zipf’s laws when separating data by disease type  <a href="#fig:structure/tcga/fraction_of_trascriptome_disease" data-reference-type="ref" data-reference="fig:structure/tcga/fraction_of_trascriptome_disease">[fig:structure/tcga/fraction_of_trascriptome_disease]</a> means that all genes contributes to define this specif label so the pre-process filter is not a good option in this case. To gain better scores in this situation were samples are affected by the cancer complexity and heterogeneity is probably necessary to add more genes to the network.</p>

<figure>
<embed src="pictures/topic/tcga/metric.pdf" id="fig:topic/tcga/metric" /><figcaption>Score across the hierarchy for TCGA. In blue the primary site labels were considered, in red the disease types and in green the mix of the two.<span label="fig:topic/tcga/metric"></span></figcaption>
</figure>
<p>Looking directly into the cluster composition the tissue separation is quite good and visually appreciable. In figure <a href="#fig:topic/tcga/fraction_clustercomposition_l4_primary_site" data-reference-type="ref" data-reference="fig:topic/tcga/fraction_clustercomposition_l4_primary_site">[fig:topic/tcga/fraction_clustercomposition_l4_primary_site]</a> clusters at the higher level of the hierarchy. Some tissues are well separated at this point, at the same time when possible samples are grouped by system, digestive system is the more evident.</p>

<figure>
<img src="pictures/topic/tcga/fraction_clustercomposition_l4_primary_site.png" alt="Clusters of diseased tissues at the higher level of the hierarchy. Breast is well separated, such as skin and brain. Cluster 6 contains digestive systems samples from pancreas and colon." /><figcaption>Clusters of diseased tissues at the higher level of the hierarchy. Breast is well separated, such as skin and brain. Cluster 6 contains digestive systems samples from pancreas and colon.</figcaption>
</figure>
<p><span id="fig:topic/tcga/fraction_clustercomposition_l4_primary_site" label="fig:topic/tcga/fraction_clustercomposition_l4_primary_site">[fig:topic/tcga/fraction_clustercomposition_l4_primary_site]</span></p>
<p>Going deeper in the hierarchy the tissue separation becomes visually appreciable and all the clusters are almost tissue-specific.</p>

<figure>
<img src="pictures/topic/tcga/fraction_clustercomposition_l3_primary_site.png" alt="text" /><figcaption>text</figcaption>
</figure>
<p><span id="fig:topic/tcga/fraction_clustercomposition_l3_primary_site" label="fig:topic/tcga/fraction_clustercomposition_l3_primary_site">[fig:topic/tcga/fraction_clustercomposition_l3_primary_site]</span></p>
<p>At this point when the model is demonstrated to work on healthy and diseased samples it can be interesting to study merged healthy and diseased labels and examine how the model behave when healthy and cancer samples are merged.</p>

<h3 id="healthy-and-diseased-together">Healthy and diseased together</h3>
<p>At this point demonstrated that the model works on samples from different dataset and performs well on both healthy and diseased samples it can be interesting to see how the model behave when both kind of data are presented to it. The goal of this part of work is to identify which genes or topics identify and distinguish tissues themselves and which drive cancer and are necessary to understand the differentiation between cancer types.</p>
<p>For this analysis were still analyzed data from GTEx and TCGA, but from a particular dataset available from <span class="citation" data-cites="Wang2017"></span> were authors tried to unify the normalization process from different dataset and sources <span class="citation" data-cites="Betel2018"></span>. These are, in practice, a mixed bigger dataset; note that not every tissue is present in both GTEx and TCGA, so only common tissues are considered here. The first label considered at this point is the tissue primary site, forgetting about its status (healthy or diseased), the secondary label refers to the tissues but separates their status. For example an healthy brain sample from GTEx and a cancer brain from TCGA share the <em>brain</em> primary site label but have different secondary site assignments.</p>
<p>Once the model is run, the first element to look at is the V-measure; in figure <a href="#fig:topic/merged/metric_scores_primarysite" data-reference-type="ref" data-reference="fig:topic/merged/metric_scores_primarysite">[fig:topic/merged/metric_scores_primarysite]</a> the result for the primary site is quite satisfying: clusters are very homogeneous and V-measure’s peak is near <span class="math inline">0.8</span>.</p>

<figure>
<embed src="pictures/topic/merged/metric_scores_primarysite.pdf" /><figcaption>V-measure score for run with merged healthy and diseased samples. Homogeneity, completeness and mutual information are represented.</figcaption>
</figure>
<p><span id="fig:topic/merged/metric_scores_primarysite" label="fig:topic/merged/metric_scores_primarysite">[fig:topic/merged/metric_scores_primarysite]</span></p>
<p>Estimating the score also for the secondary site, or rather for the tissues with the health state and for just the healthy/disease label lead to figure <a href="#fig:topic/merged/metric_scores" data-reference-type="ref" data-reference="fig:topic/merged/metric_scores">[fig:topic/merged/metric_scores]</a>. This result is quite interesting, first of all even the secondary label is well classified and this happens at a deeper level respect to th one where tissues are separated; this means that firstly samples are separated by tissues then by their health state. This is very interesting because is an evidence that the model actually recognize tissues never mind where they come from, moreover the difference between datasets are not important here and so the normalization made by <span class="citation" data-cites="Betel2018"></span> brings no problems at this level. Moreover looking just at the health status label the score is quite low (below <span class="math inline">0.2</span>) so the model does not take over the difference between datasets.</p>

<figure>
<embed src="pictures/topic/merged/metric_scores.pdf" /><figcaption>V-measure score for run with merged healthy and diseased samples. Primary site (brain, blood, pancreas..) labels are compared with secondary labels (healthy brain, brain cancer, healthy blood, blood cancer, healthy pancreas, pancreas cancer..). The health status label (healthy / diseased) is plotted.</figcaption>
</figure>
<p><span id="fig:topic/merged/metric_scores" label="fig:topic/merged/metric_scores">[fig:topic/merged/metric_scores]</span></p>
<p>To conclude the score analysis a mixed score is considered (the homogeneity of primary site is considered with the completeness of secondary label) so that the score increase if going deeper in the hierarchy the separation of a homogeneous cluster brings to separation of the refined labels. In figure <a href="#fig:topic/merged/metric_scores_all" data-reference-type="ref" data-reference="fig:topic/merged/metric_scores_all">[fig:topic/merged/metric_scores_all]</a> this score is compared with the one obtained with LDA, hierarchical clustering and the null model. What happened here is that hierarchical Stochastic Block Model performs the best, LDA approach is good hierarchical clustering have a quite bad score and all are better than shuffling null model.</p>

<figure>
<embed src="pictures/topic/merged/metric_scores_all.pdf" /><figcaption>V-measure score for run with merged healthy and diseased samples. LDA, hierarchical clustering and null model for comparison.</figcaption>
</figure>
<p><span id="fig:topic/merged/metric_scores_all" label="fig:topic/merged/metric_scores_all">[fig:topic/merged/metric_scores_all]</span></p>

<h5 id="gene-sets">Gene sets</h5>
<p>analysis is then performed. Considering the P-value of the term which P-value was the lowest, one P-value for each topic at the level of the hierarchy where the V-measure was maximized, it is possible to realize the <span class="math inline"> − <em>L</em><em>o</em><em>g</em><sub>10</sub>(<em>P</em> − <em>v</em><em>a</em><em>l</em><em>u</em><em>e</em>)</span> histogram. The tests are quite interesting, in fact there is an enrichment with a P-value lower than <span class="math inline">0.05</span> in most cases so it is possible to assert that topics carry some interesting information more than expected by picking genes at random.</p>

<figure>
<img src="pictures/topic/merged/pvaluescrosstopic.png" alt="-Log_{10}(\mathrm{P-value}) of the term with the lowest P-value in each topic. In orange the classical 0.05 threshold." id="fig:topic/merged/pvaluescrosstopic" /><figcaption><span class="math inline"> − <em>L</em><em>o</em><em>g</em><sub>10</sub>(<em>P</em> − <em>v</em><em>a</em><em>l</em><em>u</em><em>e</em>)</span> of the term with the lowest P-value in each topic. In orange the classical <span class="math inline">0.05</span> threshold.<span label="fig:topic/merged/pvaluescrosstopic"></span></figcaption>
</figure>
<p>In figure <a href="#fig:topic/merged/pvaluecategories" data-reference-type="ref" data-reference="fig:topic/merged/pvaluecategories">[fig:topic/merged/pvaluecategories]</a> are shown the categories of the terms with lower P-values. This explains what aspect of the samples topic describes. The majority of terms found in topics comes from the GTEx annotation for tissue expression, many are from GO biological process, GO molecular function and some from Human phenotype ontology.</p>

<figure>
<embed src="pictures/topic/merged/pvaluecategories.pdf" id="fig:topic/merged/pvaluecategories" /><figcaption>Categories of the terms with lower P-values in each topic.<span label="fig:topic/merged/pvaluecategories"></span></figcaption>
</figure>
<p>Going forward in the analysis it is possible to perform enrichment test with other tools such as DAVID <span class="citation" data-cites="huang2008bioinformatics huang2009systematic"></span>. Results are similar to the ones retrieved before. Tissues related terms are found also using this tool and this confirms the absence of tool or categories related biases. In figures <a href="#fig:topic/merged/DAVID_lung" data-reference-type="ref" data-reference="fig:topic/merged/DAVID_lung">[fig:topic/merged/DAVID_lung]</a>, <a href="#fig:topic/merged/DAVID_brain" data-reference-type="ref" data-reference="fig:topic/merged/DAVID_brain">[fig:topic/merged/DAVID_brain]</a> and  <a href="#fig:topic/merged/DAVID_stomach" data-reference-type="ref" data-reference="fig:topic/merged/DAVID_stomach">[fig:topic/merged/DAVID_stomach]</a> the result from DAVID enrichment analysis. Finally it is interesting to notice that topics are quite small (order<span class="math inline"> ≃ 20</span> genes), so there are no biases that can appear doing enrichment tests on big sets.</p>

<figure>
<embed src="pictures/topic/merged/DAVID_lung.pdf" /><figcaption>Caption</figcaption>
</figure>
<p><span id="fig:topic/merged/DAVID_lung" label="fig:topic/merged/DAVID_lung">[fig:topic/merged/DAVID_lung]</span></p>

<figure>
<embed src="pictures/topic/merged/DAVID_brain.pdf" /><figcaption>Caption</figcaption>
</figure>
<p><span id="fig:topic/merged/DAVID_brain" label="fig:topic/merged/DAVID_brain">[fig:topic/merged/DAVID_brain]</span></p>

<figure>
<embed src="pictures/topic/merged/DAVID_stomach.pdf" /><figcaption>Caption</figcaption>
</figure>
<p><span id="fig:topic/merged/DAVID_stomach" label="fig:topic/merged/DAVID_stomach">[fig:topic/merged/DAVID_stomach]</span></p>

<h5 id="the-link-between-topics-and-samples">The link between topics and samples</h5>
<p>has not been investigated so far. The probability distribution of each sample over topics <span class="math inline"><em>P</em>(topic|sample)</span> can be estimated as <br /><span class="math display">$$P(\text{topic}| \text{sample})=\frac{\text{\# of edges on sample from topic}}{\text{\# of edges on sample}}$$</span><br /> after the model is run. Moreover an average of all samples belonging to a topic can be estimated <span class="math inline">$P(\text{topic}| \text{tissue})=\frac{1}{\left|tissue\right|}\sum_{sample\in tissue}P(\text{topic}| \text{sample})$</span>.</p>
<p>In figure <a href="#fig:topic/merged/lifeplot" data-reference-type="ref" data-reference="fig:topic/merged/lifeplot">[fig:topic/merged/lifeplot]</a> it is plotted <span class="math inline"><em>P</em>(topic|tissue)</span> for the first topics. What is clear is that in all samples there is a global trend that present no much differences between tissues, the topic expression differences between tissues are slightly appreciable at this point. This carries a profound and very informative message: under this new point of view in nature every tissue needs somehow the expression of all the genes (there is a global trend) and small differences between genes’ expression are fine tuned to obtain different tissues. In other words it is possible to describe human tissues assuming that all genes are important and that is the fine structure of their interactions which realizes the complexity observed. In the case of diseased samples this suggest that it should be possible to discover a cancer type not looking at a few marker genes but looking at the whole expression profile of all genes.</p>

<figure>
<embed src="pictures/topic/merged/lifeplot.pdf" id="fig:topic/merged/lifeplot" /><figcaption><span class="math inline"><em>P</em>(topic|tissue)</span> for some topic colored by tissue. It is clear a global trend and in some topics there are little differences between tissues.<span label="fig:topic/merged/lifeplot"></span></figcaption>
</figure>
<p>In order to better understand these differences between topic expression in different tissues some kind of normalization inside each topic is needed. Here it was chosen to study inside each topic which tissues are most differently expressed than average. To do so from each <span class="math inline"><em>P</em>(topic|tissue)</span>was subtracted the average topic expression <span class="math inline">$\text{mean}_{\text{tissue}}(\text{topic})=\avg{P(\text{topic}| \text{tissue})}_{tissue}$</span> and the result was divided by the standard deviation <span class="math inline"><em>σ</em><sub>tissue</sub>(topic)</span>. In figure <a href="#fig:topic/merged/lifeplot_normalised_level3_hd" data-reference-type="ref" data-reference="fig:topic/merged/lifeplot_normalised_level3_hd">[fig:topic/merged/lifeplot_normalised_level3_hd]</a> some most characteristic topics are reported. This analysis reveals that tissue have a different behaviour than average in different topics, different tissues are distant from the average in different topics. Moreover the healthy and the disease sample from the two different sources seems to have a similar behaviour, in fact if an healthy tissue is far from the average in a topic, the diseased counterpart is also distant from the average as evident in the topics reported in the figure.</p>

<figure>
<embed src="pictures/topic/merged/lifeplot_normalised_level3_hd.pdf" /><figcaption><span class="math inline">$\frac{\left|P(topic | tissue) - \avg{P(\text{topic}| \text{tissue})}_{tissue}\right|}{\sigma_{\text{tissue}}(\text{topic})}$</span> or the distance of each tissue from the average tissue expression in each topic. Some interesting topics are reported.</figcaption>
</figure>
<p><span id="fig:topic/merged/lifeplot_normalised_level3_hd" label="fig:topic/merged/lifeplot_normalised_level3_hd">[fig:topic/merged/lifeplot_normalised_level3_hd]</span></p>
